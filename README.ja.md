# T2Auth

T2Authは、東京工業大学のIT施設の使用を簡素化し、ユーザーエクスペリエンスを向上させるためのChrome拡張機能です。

現在、自動ログインとコースカレンダーの生成のみをサポートしています。

## 使用方法

### オプション

左側のナビゲーションバーからページを選択できます。また、どのページでもJSONファイルを使用してオプションをインポートおよびエクスポートすることができます。

#### 設定ページ

* `言語` 現在、英語、日本語、簡体字中国語のみをサポートしています。
* `自動ログイン`：チェックを入れると、ポータルページが開かれたときに拡張機能が自動的にログインします。
* `時間割`：各期間の間隔。時刻表は公式ウェブサイトと教育ウェブシステムで見つけることができます。

#### アカウント設定ページ

アカウント、パスワード、およびマトリックス認証コードはオプションページ内で設定されます。拡張機能アイコンを右クリックしてオプションページを開くことができます。

### ログイン

[ポータル](https://portal.nap.gsic.titech.ac.jp) ページが開かれた後、

`自動ログイン`がチェックされている場合、拡張機能は自動的にログインを開始します。それ以外の場合、マトリックスコード認証ボタンを手動でクリックする必要があり、ボタンの下に拡張機能が準備完了であることを示すヒントが表示されます。

誤った情報がある場合、警告ダイアログが表示されます。

### カレンダーの生成

利用可能な場合、`日程ファイルを生成`というラベルのボタンが表示されます。

* OCWコース詳細ページが開かれた後、このボタンはコースタイトルの下に右側に表示されます。
* 教育ウェブシステムの「申告科目の登録」ページが開かれた後、このボタンは`この画面を印刷`ボタンの上に表示されます。

ボタンをクリックした後、すべての四半期の間隔を設定し、ポップアップウィンドウで省略する日を選択できます。ウィンドウの底部にある`iCalendarファイルを生成`をクリックすると、リンクが生成されます。

生成されたファイルの形式はiCalendar形式で、拡張子は`.ics`です。Googleカレンダーなどの一般的なカレンダー管理ソフトウェアにインポートできます。

## セキュリティ

* すべてのプライベート情報は、ユーザーの電子メールアドレスと識別コードによって生成されたAES-256を使用して暗号化されています。Chromeにユーザーがログインしていない場合、デフォルトのキーと初期ベクトルを使用してデータを暗号化および復号化します。
  * これは次のことを意味します：
    * ユーザーステータスが変更された場合（ログアウトしたり、アカウントを切り替えたりするなど）、ストレージ内に保存されたデータは使用できなくなります。
    * **電子メールと識別コードの両方を漏洩**した場合、この拡張機能のソースコードを持っている人はデータを復号化できる可能性があります。
    * 詳細については、<https://developer.chrome.com/docs/extensions/reference/identity/#method-getProfileUserInfo>を参照してください。
* この拡張機能のライフサイクル中に直接HTTPリクエストは作成されません。
  * これは手動で情報をサーバーに送信しないことを意味します（私のプライベートサーバーを含む）。
* オプションページでは情報を**プレーンテキスト**で出力および入力できます。これらを安全かつ信頼性のある場所に保存してください。

### 免責事項

この拡張機能を使用することで、**この拡張機能の開発者はプライバシーの漏洩に対して責任を負わない**ことに同意するものとします。

## 開発

このプロジェクトでは以下の技術を使用しています：

* [Vite](https://vitejs.dev/) と [CRXJS](https://crxjs.dev/) を使用したパッケージング
* フロントエンドレンダリングに[Mithril.js](https://mithril.js.org/) を使用
* 暗号化および復号化にmd5.jsおよび[CryptoJS](https://github.com/brix/crypto-js) を使用
* カレンダーの生成に[ical.js](https://github.com/kewisch/ical.js) を使用
* 不変の日付時刻表現に[day.js](https://day.js.org/) を使用
* 国際化に[i18next](https://www.i18next.com/) を使用
* UI表示に[Pure CSS](https://purecss.io/) を使用します。

自分の環境でビルドおよびデバッグを行いたい場合は、[この手順](https://crxjs.dev/vite-plugin/concepts/pages)に従ってください。
